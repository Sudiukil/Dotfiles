" --- Modules ---

" -- Vundle --

set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

Plugin 'VundleVim/Vundle.vim' "Plugin installer
Plugin 'othree/html5.vim' "Enhanced HTML5 completion
Plugin 'pangloss/vim-javascript' "Enhanced JavaScript completion
Plugin 'itchyny/lightline.vim' "Status line
Plugin 'scrooloose/nerdcommenter' "Easy commenting
Plugin 'scrooloose/nerdtree' "Tree file explorer
Plugin 'shawncplus/phpcomplete.vim' "Enhanced PHP completion
Plugin 'scrooloose/syntastic' "Syntax checking
Plugin 'majutsushi/tagbar' "Tags browser
Plugin 'alvan/vim-closetag' "Autoclose HTML tags
Plugin 'npacker/vim-css3complete' "Enhanced CSS3 completion
Plugin 'artur-shaik/vim-javacomplete2' "Enhanced Java completion
Plugin 'airblade/vim-gitgutter' "Git diff integration
Plugin 'terryma/vim-multiple-cursors' "Multiple cursors
Plugin 'peterhoeg/vim-qml' "QML syntax highlighting
Plugin 'vim-scripts/vim-svngutter' "SVN diff integration
Plugin 'rdnetto/YCM-Generator' "YouCompleteMe extra config generator
Plugin 'Valloric/YouCompleteMe' "Code completion

" Plugin dependencies (Debian):
" - git
" - build-essential
" - cmake
" - python-dev
" - clang
" - ctags

call vundle#end()

" -- Modules config --

" - Closetag -

let g:closetag_filenames = "*.html,*.xhtml,*.md,*.php,*.ctp"

" - LightLine -

set laststatus=2 "Always visible

" - Syntastic

let g:syntastic_python_python_exec = '/usr/bin/python3'
let g:syntastic_php_php_exec = '/opt/lampp/bin/php'
let g:syntastic_javascript_closurecompiler_path = '/usr/share/java/closure-compiler.jar'
let g:syntastic_javascript_checkers = ["closurecompiler"]

" Required for checking:
" - GCC + Clang (C/C++)
" - Python 2.x and/or 3.x (Python)
" - JDK (Java)
" - Tidy (HTML)
" - PHP (PHP)
" - Closure Compiler (Javascript)
" - LaCheck (LaTeX)

" - YCM -

let g:ycm_global_ycm_extra_conf = '~/.ycm_extra_conf.py'
let g:ycm_confirm_extra_conf = 0
let g:ycm_auto_trigger = 1
let g:ycm_autoclose_preview_window_after_insertion = 1

" --- General ---

set nocp "Vim mode only
set bs=2 "Backspace available in insert mode
filetype off "Required by Vundle
set mouse=n "Enable mouse in normal mode

" -- Display, colors, syntax --

set nu "Line numbering

set t_Co=256 "Terminal colors
colorscheme vitamins

syntax on "Syntax highlighting

set showmatch "Show matching braces

set pastetoggle=<F12> "Toggle paste mode

" -- Indent --

filetype plugin indent on "Auto indent
set noexpandtab "Use hard tabs
set tabstop=4 "Tabs size
set shiftwidth=4

" -- Completion --

" - Java -

autocmd FileType java set omnifunc=javacomplete#Complete
imap <F4> <Plug>(JavaComplete-Imports-Add)
imap <F4> <Plug>(JavaComplete-Imports-RemoveUnused)
nmap <F4> <Plug>(JavaComplete-Imports-Add)
nmap <F4> <Plug>(JavaComplete-Imports-RemoveUnused)

" - Web (HTML/CSS/PHP/JavaScript) -

autocmd FileType html set omnifunc=htmlcomplete#CompleteTags
autocmd FileType css set omnifunc=csscomplete#CompleteCSS
autocmd FileType php set omnifunc=phpcomplete#CompletePHP
autocmd FileType javascript set omnifunc=javascriptcomplete#CompleteJS

" - LaTeX -

" -- Search options --

set incsearch "Dynamic cursor while searching
set ignorecase
set smartcase

" -- Mapping (normal mode) --

" - Global -

nmap j gj
nmap k gk

nmap <C-p> :setlocal spell spelllang=<CR>
nmap <C-p>f :setlocal spell spelllang=fr<CR>
nmap <C-p>e :setlocal spell spelllang=en<CR>

let mapleader = ","

" - Tabs management -

map <ESC>[a <S-up>
map <ESC>[b <S-down>
map <ESC>[c <S-right>
map <ESC>[d <S-left>

nmap <S-down> :tabnew<CR>
nmap <S-right> gt
nmap <S-left> gT
nmap <S-up><S-left> :tabmove -1<CR>
nmap <S-up><S-right> :tabmove +1<CR>

" - Windows management -

map <ESC>Oa <C-up>
map <ESC>Ob <C-down>
map <ESC>Oc <C-right>
map <ESC>Od <C-left>

nmap <C-v> :vsplit<CR>:NERDTreeToggle<CR>
nmap <C-h> :split<CR>:NERDTreeToggle<CR>
nmap <C-w> :close<CR>
nmap <C-up> :wincmd k<CR>
nmap <C-down> :wincmd j<CR>
nmap <C-left> :wincmd h<CR>
nmap <C-right> :wincmd l<CR>
nmap + :wincmd +<CR>
nmap - :wincmd -<CR>

" - Modules -

nmap <Space> :NERDTreeToggle<CR>
nmap <C-o> :TagbarToggle<CR>:wincmd w<CR>
nmap <C-g> :GitGutterToggle<CR>

" - Edit and reload Vim config

nmap <leader>vc :vsplit ~/.vimrc<CR>
nmap <leader>vr :source ~/.vimrc<CR>

" -- Spell checking --

autocmd FileType text setlocal spell spelllang=fr
autocmd FileType tex setlocal spell spelllang=fr
autocmd FileType html setlocal spell spelllang=fr
autocmd FileType php setlocal spell spelllang=fr

" --- Abbreviations ---

" -- LaTeX --

autocmd FileType plaintex set filetype=tex

autocmd FileType tex iab newp \part{
autocmd FileType tex iab news \section{
autocmd FileType tex iab newss \subsection{
autocmd FileType tex iab newsss \subsubsection{
autocmd FileType tex iab § \paragraph{

autocmd FileType tex iab itemize \begin{itemize}<CR>\item<CR>\end{itemize}<Up>
autocmd FileType tex iab enumerate \begin{enumerate}<CR>\item<CR>\end{enumerate}<up>
autocmd FileType tex iab item \item

autocmd FileType tex iab underline \underline{
autocmd FileType tex iab bold \textbf{
autocmd FileType tex iab emph \emph{

autocmd FileType tex iab €€ \euro

autocmd FileType tex iab resetsec \setcounter{section}{0}

autocmd FileType tex iab pause \pause~\\

autocmd FileType tex iab -> \rightarrow
autocmd FileType tex iab <- \leftarrow
autocmd FileType tex iab $-> $\rightarrow
autocmd FileType tex iab $<- $\leftarrow

autocmd FileType tex iab --> \Rightarrow
autocmd FileType tex iab <-- \Leftarrow
autocmd FileType tex iab $--> $\Rightarrow
autocmd FileType tex iab $<-- $\Leftarrow

map <F5> :w<CR>:!pdflatex % && pdflatex %<CR><CR>
map <F6> :w<CR>:!xelatex % && xelatex %<CR><CR>
